@startuml
title REGISTRAZIONE PRESTITO

actor Bibliotecario
participant View
participant Controller
participant LoanManagement
participant FileManager
participant Book
participant User

Bibliotecario -> View: Accede al menu pretiti
View -> Controller: Mostra operazioni disponibili
Bibliotecario -> View: Seleziona "Nuovo Prestito"
View -> Controller: Richiesta registrazione prestito
Controller -> LoanManagement: Verifica condizioni (limite prestiti, copie disponibili)

alt Condizioni rispettate
    LoanManagement -> Controller: Condizioni rispettate
    Controller -> LoanManagement: add(Loan l)
    LoanManagement -> Book: Decrementa copie disponibili
    LoanManagement -> User: Aggiorna lista prestiti utente
    LoanManagement -> FileManager: updateFileObject(Loan l, String filename)
    Controller -> View: Conferma prestito registrato
    View -> Bibliotecario: Prestito registrato con successo
else Condizioni non rispettate
    Controller -> View: Mostra messaggio di errore
    View -> Bibliotecario: Prestito non consentito
end
@enduml

